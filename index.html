<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>2048 Clone</title>

<style>
  body {
    font-family: system-ui, sans-serif;
    background: #faf8ef;
    display: flex;
    justify-content: center;
    padding: 20px;
  }

  .game {
    width: 320px;
    text-align: center;
  }

  h1 {
    margin: 10px 0;
  }

  .grid {
    background: #bbada0;
    padding: 10px;
    border-radius: 10px;
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 10px;
    touch-action: none;
  }

  .tile {
    background: #cdc1b4;
    border-radius: 6px;
    height: 65px;
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 24px;
    font-weight: bold;
    color: #776e65;
  }

  .tile[data-value="2"] { background: #eee4da; }
  .tile[data-value="4"] { background: #ede0c8; }
  .tile[data-value="8"] { background: #f2b179; color: #fff; }
  .tile[data-value="16"] { background: #f59563; color: #fff; }
  .tile[data-value="32"] { background: #f67c5f; color: #fff; }
  .tile[data-value="64"] { background: #f65e3b; color: #fff; }
  .tile[data-value="128"] { background: #edcf72; }
  .tile[data-value="256"] { background: #edcc61; }
  .tile[data-value="512"] { background: #edc850; }
  .tile[data-value="1024"] { background: #edc53f; }
  .tile[data-value="2048"] { background: #edc22e; }

  .controls {
    margin-top: 15px;
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 8px;
  }

  button {
    padding: 10px;
    font-size: 18px;
    border-radius: 6px;
    border: none;
    background: #8f7a66;
    color: white;
  }

  button:active {
    opacity: 0.8;
  }
</style>
</head>

<body>
<div class="game">
  <h1>2048</h1>

  <div class="grid" id="grid"></div>

  <div class="controls">
    <div></div>
    <button onclick="move('up')">⬆️</button>
    <div></div>
    <button onclick="move('left')">⬅️</button>
    <button onclick="move('down')">⬇️</button>
    <button onclick="move('right')">➡️</button>
  </div>
</div>

<script>
  const size = 4;
  let board = Array(size * size).fill(0);
  const grid = document.getElementById("grid");

  function init() {
    addTile();
    addTile();
    render();
  }

  function addTile() {
    const empty = board
      .map((v, i) => (v === 0 ? i : null))
      .filter(v => v !== null);

    if (!empty.length) return;
    const i = empty[Math.floor(Math.random() * empty.length)];
    board[i] = Math.random() < 0.9 ? 2 : 4;
  }

  function render() {
    grid.innerHTML = "";
    board.forEach(value => {
      const tile = document.createElement("div");
      tile.className = "tile";
      if (value) {
        tile.textContent = value;
        tile.dataset.value = value;
      }
      grid.appendChild(tile);
    });
  }

  function slide(row) {
    row = row.filter(v => v);
    for (let i = 0; i < row.length - 1; i++) {
      if (row[i] === row[i + 1]) {
        row[i] *= 2;
        row[i + 1] = 0;
      }
    }
    return row.filter(v => v);
  }

  function move(dir) {
    let moved = false;

    for (let i = 0; i < size; i++) {
      let row = [];

      for (let j = 0; j < size; j++) {
        const index =
          dir === "left" || dir === "right"
            ? i * size + j
            : j * size + i;

        row.push(board[index]);
      }

      if (dir === "right" || dir === "down") row.reverse();

      const newRow = slide(row);
      while (newRow.length < size) newRow.push(0);

      if (dir === "right" || dir === "down") newRow.reverse();

      for (let j = 0; j < size; j++) {
        const index =
          dir === "left" || dir === "right"
            ? i * size + j
            : j * size + i;

        if (board[index] !== newRow[j]) {
          board[index] = newRow[j];
          moved = true;
        }
      }
    }

    if (moved) {
      addTile();
      render();
    }
  }

  // Touch swipe controls
  let startX = 0, startY = 0;

  grid.addEventListener("touchstart", e => {
    startX = e.touches[0].clientX;
    startY = e.touches[0].clientY;
  });

  grid.addEventListener("touchend", e => {
    const dx = e.changedTouches[0].clientX - startX;
    const dy = e.changedTouches[0].clientY - startY;

    if (Math.abs(dx) > Math.abs(dy)) {
      if (dx > 30) move("right");
      if (dx < -30) move("left");
    } else {
      if (dy > 30) move("down");
      if (dy < -30) move("up");
    }
  });

  init();
</script>
</body>
</html>
